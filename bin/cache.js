var $jscomp={scope:{},findInternal:function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
var creepsInArmy={},spawnsInRoom={},powerSpawnsInRoom={},extensionsInRoom={},towersInRoom={},labsInRoom={},nukersInRoom={},containersInRoom={},linksInRoom={},repairableStructuresInRoom={},sortedRepairableStructuresInRoom={},extractorsInRoom={},portalsInRoom={},hostilesInRoom={},sourceKeepersInRoom={},costMatricies={},Cache={creepTasks:{},roomTypes:{},spawning:{},minerals:{},log:{},reset:function(){creepsInArmy={};spawnsInRoom={};powerSpawnsInRoom={};extensionsInRoom={};towersInRoom={};labsInRoom=
{};nukersInRoom={};containersInRoom={};linksInRoom={};repairableStructuresInRoom={};sortedRepairableStructuresInRoom={};extractorsInRoom={};portalsInRoom={};hostilesInRoom={};sourceKeepersInRoom={};costMatricies={};Cache.creepTasks={};Cache.roomTypes={};Cache.spawning={};Cache.minerals={};Cache.log={events:[],hostiles:[],creeps:[],spawns:[],structures:[],rooms:{},army:{}};Cache.credits=Game.market.credits;Memory.visualizations&&(Cache.time=(new Date).toLocaleString("en-US",{timeZone:"America/Los_Angeles"}).replace(",",
""))},creepsInArmy:function(a,b){creepsInArmy[b]||(creepsInArmy[b]={});creepsInArmy[b].all||(creepsInArmy[b].all=_.filter(Game.creeps,function(a){return a.memory.army===b}));return creepsInArmy[b][a]?creepsInArmy[b][a]:creepsInArmy[b][a]=_.filter(creepsInArmy[b].all,function(b){return b.memory.role===a})},spawnsInRoom:function(a){return spawnsInRoom[a.name]?spawnsInRoom[a.name]:spawnsInRoom[a.name]=_.filter(a.find(FIND_MY_STRUCTURES),function(a){return a.structureType===STRUCTURE_SPAWN})},powerSpawnsInRoom:function(a){return powerSpawnsInRoom[a.name]?
powerSpawnsInRoom[a.name]:powerSpawnsInRoom[a.name]=_.filter(a.find(FIND_MY_STRUCTURES),function(a){return a.structureType===STRUCTURE_POWER_SPAWN})},extensionsInRoom:function(a){return extensionsInRoom[a.name]?extensionsInRoom[a.name]:extensionsInRoom[a.name]=_.filter(a.find(FIND_MY_STRUCTURES),function(a){return a.structureType===STRUCTURE_EXTENSION})},towersInRoom:function(a){return towersInRoom[a.name]?towersInRoom[a.name]:towersInRoom[a.name]=_.filter(a.find(FIND_MY_STRUCTURES),function(a){return a.structureType===
STRUCTURE_TOWER})},labsInRoom:function(a){return labsInRoom[a.name]?labsInRoom[a.name]:labsInRoom[a.name]=_.filter(a.find(FIND_MY_STRUCTURES),function(a){return a.structureType===STRUCTURE_LAB})},nukersInRoom:function(a){return nukersInRoom[a.name]?nukersInRoom[a.name]:nukersInRoom[a.name]=_.filter(a.find(FIND_MY_STRUCTURES),function(a){return a.structureType===STRUCTURE_NUKER})},containersInRoom:function(a){return containersInRoom[a.name]?containersInRoom[a.name]:containersInRoom[a.name]=_.filter(a.find(FIND_STRUCTURES),
function(a){return a.structureType===STRUCTURE_CONTAINER})},linksInRoom:function(a){return linksInRoom[a.name]?linksInRoom[a.name]:linksInRoom[a.name]=a.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_LINK}})},repairableStructuresInRoom:function(a){return repairableStructuresInRoom[a.name]?repairableStructuresInRoom[a.name]:repairableStructuresInRoom[a.name]=a.find(FIND_STRUCTURES,{filter:function(a){return(a.my||a.structureType===STRUCTURE_WALL||a.structureType===STRUCTURE_ROAD||
a.structureType===STRUCTURE_CONTAINER)&&a.hits}})},sortedRepairableStructuresInRoom:function(a){return sortedRepairableStructuresInRoom[a.name]?sortedRepairableStructuresInRoom[a.name]:sortedRepairableStructuresInRoom[a.name]=Cache.repairableStructuresInRoom(a).sort(function(a,c){return a.hits-c.hits})},extractorsInRoom:function(a){return extractorsInRoom[a.name]?extractorsInRoom[a.name]:extractorsInRoom[a.name]=a.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_EXTRACTOR}})},
portalsInRoom:function(a){return portalsInRoom[a.name]?portalsInRoom[a.name]:portalsInRoom[a.name]=a.find(FIND_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_PORTAL}})},hostilesInRoom:function(a){var b=a.name,c;if(!a||a.unobservable)return[];c=hostilesInRoom[a.name]?hostilesInRoom[a.name]:hostilesInRoom[a.name]=_.filter(a.find(FIND_HOSTILE_CREEPS),function(a){return!a.owner||-1===Memory.allies.indexOf(a.owner.username)});Memory.rooms[b].hostiles||(Memory.rooms[b].hostiles=[]);_.forEach(c,
function(a){-1!==Memory.rooms[b].hostiles.indexOf(a.id)&&(Memory.rooms[b].harvested=0)});a.memory.hostiles=_.map(c,function(a){return a.id});return c},sourceKeepersInRoom:function(a){return sourceKeepersInRoom[a.name]?sourceKeepersInRoom[a.name]:sourceKeepersInRoom[a.name]=a.find(FIND_HOSTILE_STRUCTURES,{filter:function(a){return a.structureType===STRUCTURE_KEEPER_LAIR}})},getCostMatrix:function(a){var b=a.name;if(!a||a.unobservable)return new PathFinder.CostMatrix;if(!costMatricies[b]){var c=new PathFinder.CostMatrix;
_.forEach(a.find(FIND_STRUCTURES),function(a){var b=a.pos;a.structureType===STRUCTURE_ROAD?c.set(b.x,b.y,1):a.structureType===STRUCTURE_CONTAINER?c.set(b.x,b.y,10):a.structureType===STRUCTURE_RAMPART&&a.my||c.set(b.x,b.y,255)});_.forEach(a.find(FIND_MY_CONSTRUCTION_SITES),function(a){a=a.pos;c.set(a.x,a.y,5)});_.forEach(Cache.portalsInRoom(a),function(a){a=a.pos;c.set(a.x,a.y,5)});Memory.avoidSquares[b]&&_.forEach(Memory.avoidSquares[b],function(a){c.set(a.x,a.y,255)});Memory.rooms[b]&&Memory.rooms[b].roomType&&
"source"===Memory.rooms[b].roomType.type||_.forEach(_.filter(a.find(FIND_HOSTILE_CREEPS),function(a){return"Source Keeper"===a.owner.username}),function(a){a=a.pos;for(var b=a.x-3;b<a.x+3;b++)for(var d=a.y-3;d<a.y+3;d++)c.set(b,d,255)});costMatricies[b]=c}return costMatricies[b]}};require("screeps-profiler").registerObject(Cache,"Cache");module.exports=Cache;