var $jscomp={scope:{},checkStringArgs:function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<e;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6-impl","es3");$jscomp.polyfill("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}},"es6-impl","es3");
$jscomp.polyfill("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");var usedOnStart=0,enabled=!1,depth=0;
function setupProfiler(){depth=0;Game.profiler={stream:function(a,b,c){setupMemory("stream",a||10,b,c)},email:function(a,b,c){setupMemory("email",a||100,b,c)},profile:function(a,b,c){setupMemory("profile",a||100,b,c)},background:function(a,b){setupMemory("background",!1,a,b)},restart:function(){if(Profiler.isProfiling()){var a=Memory.profiler.filter,b=!1;Memory.profiler.disableTick&&(b=Memory.profiler.disableTick-Memory.profiler.enabledTick+1);setupMemory(Memory.profiler.type,b,a)}},reset:resetMemory,
output:Profiler.output};overloadCPUCalc()}function setupMemory(a,b,c,d){resetMemory();b=Number.isInteger(b)?Game.time+b:!1;Memory.profiler||(Memory.profiler={map:{},totalTime:0,enabledTick:Game.time+1,disableTick:b,type:a,filter:c,startsWith:d})}function resetMemory(){Memory.profiler=null}function overloadCPUCalc(){Game.rooms.sim&&(usedOnStart=0,Game.cpu.getUsed=function(){return performance.now()-usedOnStart})}function getFilter(){return Memory.profiler.filter}
function getStartsWith(){return Memory.profiler.startsWith}var functionBlackList=["getUsed","constructor"];function wrapFunction(a,b){return function(){if(Profiler.isProfiling()){var c=Memory.profiler.startsWith?a.startsWith(getFilter()):a===getFilter(),d=Game.cpu.getUsed();c&&depth++;var e=b.apply(this,arguments);if(0<depth||!getFilter()){var f=Game.cpu.getUsed();Profiler.record(a,f-d)}c&&depth--;return e}return b.apply(this,arguments)}}
function hookUpPrototypes(){Profiler.prototypes.forEach(function(a){profileObjectFunctions(a.val,a.name)})}function profileObject(a,b){Object.getOwnPropertyNames(a).forEach(function(c){var d=b+"."+c;try{var e="function"===typeof a[c],f=-1===functionBlackList.indexOf(c);e&&f&&(a[c]=profileFunction(a[c],d))}catch(g){}});return a}function profileObjectFunctions(a,b){a.prototype&&profileObject(a.prototype,b);profileObject(a,b)}
function profileFunction(a,b){b=b||a.name;return b?wrapFunction(b,a):(console.log("Couldn't find a function name for - ",a),console.log("Will not profile this function."),a)}
var Profiler={printProfile:function(){console.log(Profiler.output())},emailProfile:function(){Game.notify(Profiler.output())},output:function(a){a=a?a:20;if(!Memory.profiler||!Memory.profiler.enabledTick)return"Profiler not active.";var b=Game.time-Memory.profiler.enabledTick+1,b=["Avg: "+(Memory.profiler.totalTime/b).toFixed(2),"Total: "+Memory.profiler.totalTime.toFixed(2),"Ticks: "+b].join("\t");return[].concat("calls\t\ttime\t\tavg\t\tfunction",Profiler.lines().slice(0,a),b).join("\n")},lines:function(){return Object.keys(Memory.profiler.map).map(function(a){var b=
Memory.profiler.map[a];return{name:a,calls:b.calls,totalTime:b.time,averageTime:b.time/b.calls}}).sort(function(a,b){return b.totalTime-a.totalTime}).map(function(a){return[a.calls,a.totalTime.toFixed(1),a.averageTime.toFixed(3),a.name].join("\t\t")})},prototypes:[{name:"Game",val:Game},{name:"Room",val:Room},{name:"Structure",val:Structure},{name:"Spawn",val:Spawn},{name:"Creep",val:Creep},{name:"RoomPosition",val:RoomPosition},{name:"Source",val:Source},{name:"Flag",val:Flag}],record:function(a,
b){Memory.profiler.map[a]||(Memory.profiler.map[a]={time:0,calls:0});Memory.profiler.map[a].calls++;Memory.profiler.map[a].time+=b},endTick:function(){if(Game.time>=Memory.profiler.enabledTick){var a=Game.cpu.getUsed();Memory.profiler.totalTime+=a;Profiler.report()}},report:function(){Profiler.shouldPrint()?Profiler.printProfile():Profiler.shouldEmail()&&Profiler.emailProfile()},isProfiling:function(){return enabled&&Memory.profiler?!Memory.profiler.disableTick||Game.time<=Memory.profiler.disableTick:
!1},type:function(){return Memory.profiler.type},shouldPrint:function(){var a="stream"===Profiler.type(),b="profile"===Profiler.type(),c=Memory.profiler.disableTick===Game.time;return a||b&&c},shouldEmail:function(){return"email"===Profiler.type()&&Memory.profiler.disableTick===Game.time}};
module.exports={wrap:function(a){enabled&&setupProfiler();return Profiler.isProfiling()?(usedOnStart=Game.cpu.getUsed(),a=a(),Profiler.endTick(),a):a()},enable:function(){enabled=!0;hookUpPrototypes()},output:Profiler.output,registerObject:profileObjectFunctions,registerFN:profileFunction,registerClass:profileObjectFunctions};